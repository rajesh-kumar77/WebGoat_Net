  # See FortifyVulnerabilityExporter documentation for FoD connection settings and release selection

export:
  from: fod
  to: csv

#fod:
#  vulnerability:
    # embed:                  # Load extra data, depending on what data you want to include in output
    #   - subEntity: details

export.dir: ${export.default.dir} # Use default export directory (unless overridden)
csv:
  output:
    stdout: false             # Disabled by default to avoid vulnerability data being exposed through log files
    header: true
    file:   ${export.dir}/${release.applicationName}-${release.releaseName}.csv
  fields:
    Date: $[vuln.introducedDate]
    Title: $[vuln.category]
    CweId: $[vuln.cwe?.replaceAll("CWE-","").substring(0,(vuln.cwe?.replaceAll("CWE-","").indexOf(",")==-1?vuln.cwe?.replaceAll("CWE-","").length():vuln.cwe?.replaceAll("CWE-","").indexOf(",")))]
    Url: $[vuln.deepLink]
    Severity: $[(vuln.severityString matches "(Critical|Medium)") ? "High":"Low" ]
    Description: $[#abbreviate(#htmlToText(vuln.details?.summary), 15000)]
    Mitigation: $[#abbreviate(#htmlToText(vuln.details?.explanation)+'\n\n'+#htmlToText(vuln.recommendations?.recommendations), 7000)]
    Impact: 
    References: 
    Active: $[!vuln.closedStatus]
    Verified: $[vuln.bugSubmitted]
    FalsePositive: $[vuln.isSuppressed]
    Duplicate: false
